(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e48f924c"],{"031c":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upload-res"},[a("div",{staticClass:"content"},[9030===e.fileInfo.file_type?a("div",{staticClass:"current-video"},[e._v("当前视频："+e._s(e.fileInfo.file_name))]):e._e(),9031===e.fileInfo.file_type?a("div",{staticClass:"current-video"},[e._v("当前文档："+e._s(e.fileInfo.file_name))]):e._e(),9032===e.fileInfo.file_type?a("div",{staticClass:"current-video"},[e._v("其他："+e._s(e.fileInfo.file_name))]):e._e(),a("div",{staticClass:"res-cover"},[e._m(0),a("div",{staticClass:"upload-wrap"},[a("div",{staticClass:"upload"},[a("input",{attrs:{type:"file"},on:{change:e.handleUploadCoverPic}}),a("i",{staticClass:"p-center el-icon-plus avatar-uploader-icon"}),e.selectImgPic.url?a("img",{attrs:{src:e.selectImgPic.url,alt:""}}):e._e(),e.selectImgPic.url?a("div",{staticClass:"cover-logo"},[e._v("上传封面")]):e._e()]),a("div",{staticClass:"cover-select"},[a("div",{staticClass:"note"},[e._v("可以选择以下封面")]),a("div",{staticClass:"covers"},e._l(e.fileList,function(t,s){return a("div",{key:s,staticClass:"cover-item",class:{active:t===e.selectImgPic.url}},[t?a("img",{attrs:{src:t,alt:""},on:{click:function(a){e.handleChangeCoverPic(t)}}}):e._e(),a("i",{staticClass:"iconfont icon-picture p-center"})])}))])]),a("div",{staticClass:"res-info"},[a("div",{staticClass:"left"},[a("div",{staticClass:"res-name"},[a("span",{staticClass:"red-dot"},[e._v("资源名称：")]),a("el-input",{model:{value:e.resourceName,callback:function(t){e.resourceName=t},expression:"resourceName"}})],1),a("div",{staticClass:"res-type"},[a("span",{staticClass:"red-dot"},[e._v("资源类型：")]),[a("el-radio",{attrs:{label:"9060"},model:{value:e.resourceType,callback:function(t){e.resourceType=t},expression:"resourceType"}},[e._v("学科教育")]),a("el-radio",{attrs:{label:"9061"},model:{value:e.resourceType,callback:function(t){e.resourceType=t},expression:"resourceType"}},[e._v("教育活动")])]],2),a("div",{staticClass:"relate-course"},[a("span",{staticClass:"red-dot"},[e._v("相关课程：")]),a("el-input",{staticStyle:{width:"475px"},attrs:{"suffix-icon":"el-icon-arrow-down",placeholder:"请选择相关课程"},nativeOn:{click:function(t){t.stopPropagation(),e.showSelect=!0}},model:{value:e.selectedLesson.label,callback:function(t){e.$set(e.selectedLesson,"label",t)},expression:"selectedLesson.label"}}),e.showSelect?a("div",{directives:[{name:"clickOutSide",rawName:"v-clickOutSide",value:e.handleOutFocusInput,expression:"handleOutFocusInput"}],staticClass:"select-wrap"},[a("div",{staticClass:"select-items"},[a("el-select",{attrs:{placeholder:"全部学段"},model:{value:e.stageValue,callback:function(t){e.stageValue=t},expression:"stageValue"}},[a("el-option",{attrs:{value:"-1",label:"全部学段"}}),e._l(e.allStageList,function(e){return a("el-option",{key:e.code,attrs:{value:e.code,label:e.text}})})],2),a("el-select",{attrs:{placeholder:"全部科目"},model:{value:e.subjectValue,callback:function(t){e.subjectValue=t},expression:"subjectValue"}},[a("el-option",{attrs:{value:"-1",label:"全部科目"}}),e._l(e.allSubject,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2),a("el-select",{attrs:{placeholder:"全部年级"},model:{value:e.gradeValue,callback:function(t){e.gradeValue=t},expression:"gradeValue"}},[a("el-option",{attrs:{label:"全部年级",value:"-1"}}),e._l(e.allGradeList,function(e){return a("el-option",{key:e.id,attrs:{value:e.code,label:e.text}})})],2),a("el-select",{attrs:{placeholder:"全部版本"},model:{value:e.versionValue,callback:function(t){e.versionValue=t},expression:"versionValue"}},[a("el-option",{attrs:{value:"-1",label:"全部版本"}}),e._l(e.allVersionList,function(e){return a("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})})],2)],1),a("div",{staticClass:"select-lists"},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("el-tree",{attrs:{"empty-text":"请选择正确的学段/科目/年级/版本",data:e.treeList,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1)],1)]):e._e()],1)]),a("div",{staticClass:"right"},[a("el-input",{attrs:{type:"textarea",placeholder:"讲讲这个资源的故事，让更多人了解",rows:5,resize:"none",maxlength:"300","show-word-limit":""},model:{value:e.resourceMask,callback:function(t){e.resourceMask=t},expression:"resourceMask"}})],1)]),a("div",{staticClass:"advance-course"},[a("div",{staticClass:"title",on:{click:function(t){e.showAdvance=!e.showAdvance}}},[e._v("\n          高级选项\n          "),a("i",{class:e.showAdvance?"el-icon-arrow-up":"el-icon-arrow-down"})]),e.showAdvance?[a("div",{staticClass:"advance-content"},[a("div",{staticClass:"authty"},[a("div",{staticClass:"visited"},[a("span",[e._v("访问权限：")]),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.authType,callback:function(t){e.authType=t},expression:"authType"}},[a("el-option",{attrs:{label:"公开",value:"9070"}}),a("el-option",{attrs:{label:"指定机构",value:"9071"}}),a("el-option",{attrs:{label:"凭密码查看",value:"9072"}})],1),"9071"===e.authType?[a("el-input",{staticStyle:{"margin-left":"15px",width:"260px"},attrs:{placeholder:"请选择指定机构"},on:{focus:e.handleFocus},model:{value:e.orgValueText,callback:function(t){e.orgValueText=t},expression:"orgValueText"}})]:e._e(),"9072"===e.authType?[a("el-input",{staticStyle:{"margin-left":"15px",width:"260px"},attrs:{placeholder:"请填写密码"},model:{value:e.authPassword,callback:function(t){e.authPassword=t},expression:"authPassword"}})]:e._e()],2),a("div",{staticClass:"down"},[a("span",[e._v("下载权限：")]),a("el-switch",{attrs:{"active-value":"1","inactive-value":"2","active-color":"#409EFF","inactive-color":"#ccc"},model:{value:e.canDownload,callback:function(t){e.canDownload=t},expression:"canDownload"}})],1)]),a("div",{staticClass:"res-upload"},[a("span",[e._v("资源附件:")]),a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"http-request":e.handleUploadFile,"before-remove":e.handleRemoveFile,action:""}},[a("div",{staticClass:"upload-btn"},[e._v("上传")])])],1)])]:e._e()],2),a("div",{staticClass:"save",on:{click:e.handleSave}},[e._v("保存发布")])])]),a("resFooter"),a("div",{staticClass:"transfer"},[a("el-transfer",{attrs:{filterable:"","filter-placeholder":"请输机构名筛选",data:e.allOrg,"filter-method":e.filterMethod},model:{value:e.authOrgArray,callback:function(t){e.authOrgArray=t},expression:"authOrgArray"}})],1)],1)},l=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title"},[a("span",{staticClass:"name red-dot"},[e._v("资源封面：")]),a("span",{staticClass:"size"},[e._v("建议尺寸: 288*162")])])}],i=a("1908"),n=i["a"],c=(a("d4fa"),a("eaa3"),a("2877")),r=Object(c["a"])(n,s,l,!1,null,"2b0c1124",null);r.options.__file="upload-res.vue";t["default"]=r.exports},1908:function(e,t,a){"use strict";(function(e){var s=a("2909");a("7f7f"),a("6c7b"),a("cadf"),a("551c"),a("097d");t["a"]={props:["id"],components:{resFooter:function(){return a.e("chunk-db84157e").then(a.bind(null,"0d5c"))}},data:function(){return{filterMethod:function(e,t){return t.label.indexOf(e)>-1},showAdvance:!1,showSelect:!1,fileInfo:{},selectImgPic:{file:"",url:""},fileList:new Array(4).fill(0),allStageList:[],stageValue:"-1",allSubject:[],subjectValue:"-1",allGradeList:[],gradeValue:"-1",allVersionList:[],versionValue:"-1",treeList:[],defaultProps:{children:"children",label:"name"},selectedLesson:{value:"",label:""},resourceName:"",resourceMask:"",resourceType:"9060",authType:"9070",authPassword:"",orgValueText:"",allOrg:[],authOrgArray:[],selectedArray:[],canDownload:"1",attachmentList:[]}},watch:{watchChange:function(e){this.getSubjectTree()}},computed:{watchChange:function(){return{stageValue:this.stageValue,subjectValue:this.subjectValue,gradeValue:this.gradeValue,versionValue:this.versionValue}}},created:function(){this.initInfo(),this.getAllGrade(),this.getAllSubject(),this.getAllClass(),this.getAllVersion(),this.selectSchoolForPublicResource(),this.getSubjectTree()},methods:{selectSchoolForPublicResource:function(){var e=this;this.$api.selectSchoolForPublicResource().then(function(t){e.allOrg=t.data.map(function(e){return{label:e.displayName,key:e.id}})})},initInfo:function(){var e=this;this.$api.selectFileInfo(this.id).then(function(t){e.fileInfo=t.data,e.fileList.splice(0,1,t.data.img_url)})},getSubjectTree:function(){var e=this,t={gradeId:this.gradeValue,periodId:this.stageValue,subjectId:this.subjectValue,textbookVersionId:this.versionValue};this.$api.getSubjectTree(t).then(function(t){e.treeList=t.data})},getAllGrade:function(){var e=this,t={type:"stage"};this.$api.dictGetByType(t).then(function(t){e.allStageList=t.data})},getAllSubject:function(){var e=this;this.$api.getSubjectByGrade().then(function(t){e.allSubject=t.data})},getAllClass:function(){var e=this,t={type:"grade"};this.$api.dictGetByType(t).then(function(t){e.allGradeList=t.data})},getAllVersion:function(){var e=this;this.$api.getKeyAndValue().then(function(t){e.allVersionList=t.data})},handleFocus:function(){var t=this;this.authOrgArray=this.selectedArray,this.$myLayer.formLayer("指定机构查看",e(".transfer"),["749px","536px"],function(){t.selectedArray=t.authOrgArray,t.selectedArray.length>0?t.orgValueText=t.selectedArray.length+"个":t.orgValueText=""})},handleUploadCoverPic:function(e){var t=e.target.files[0],a=window.URL.createObjectURL(t);this.selectImgPic={url:a,file:t}},handleChangeCoverPic:function(e){if(!e)return!1;this.selectImgPic={url:e,file:""}},handleOutFocusInput:function(e){this.showSelect=!1},handleNodeClick:function(e){e.hasNext||(this.selectedLesson={value:e.id,label:e.name},this.handleOutFocusInput())},checkRequiredParams:function(){return!!(this.resourceName&&this.selectImgPic.url&&this.selectedLesson.value)||(this.$myLayer.dangerLayer("请完善资源信息"),!1)},handleRemoveFile:function(e){var t=this.attachmentList.filter(function(t){return t.attachmentName!=e.name});this.attachmentList=Object(s["a"])(t)},handleUploadFile:function(e){var t=this,a=new FormData;a.append("file",e.file),this.$api.uploadFileCoverPic(a).then(function(a){var s={attachmentName:e.file.name,attachmentUrl:a.data};t.attachmentList.push(s)})},handleSave:function(){var e=this;if(!this.checkRequiredParams())return!1;var t={resourcePic:this.selectImgPic.url,resourceName:this.resourceName,resourceMask:this.resourceMask,resourceType:this.resourceType,catalogId:this.selectedLesson.value,stageId:this.stageValue,subjectId:this.subjectValue,gradeId:this.gradeValue,versionId:this.versionValue,authType:this.authType,authPassword:this.authPassword,authOrgArray:this.selectedArray,canDownload:this.canDownload,attachmentList:this.attachmentList,fileId:this.fileInfo.file_id,fileType:this.fileInfo.file_type,fileTime:this.fileInfo.runing_time};if(this.selectImgPic.file){var a=new FormData;a.append("file",this.selectImgPic.file),this.$api.uploadFileCoverPic(a).then(function(a){t.resourcePic=a.data,e.$api.saveResourceInfo(t).then(function(t){e.$myLayer.successLayer("发布成功")})})}else this.$api.saveResourceInfo(t).then(function(t){e.$myLayer.successLayer("发布成功")})}}}}).call(this,a("1157"))},2909:function(e,t,a){"use strict";function s(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}function l(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function n(e){return s(e)||l(e)||i()}a.d(t,"a",function(){return n})},"36bd":function(e,t,a){"use strict";var s=a("4bf8"),l=a("77f1"),i=a("9def");e.exports=function(e){var t=s(this),a=i(t.length),n=arguments.length,c=l(n>1?arguments[1]:void 0,a),r=n>2?arguments[2]:void 0,o=void 0===r?a:l(r,a);while(o>c)t[c++]=e;return t}},"6c7b":function(e,t,a){var s=a("5ca1");s(s.P,"Array",{fill:a("36bd")}),a("9c6c")("fill")},"7f7f":function(e,t,a){var s=a("86cc").f,l=Function.prototype,i=/^\s*function ([^ (]*)/,n="name";n in l||a("9e1e")&&s(l,n,{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(e){return""}}})},abde:function(e,t,a){},d1d0:function(e,t,a){},d4fa:function(e,t,a){"use strict";var s=a("abde"),l=a.n(s);l.a},eaa3:function(e,t,a){"use strict";var s=a("d1d0"),l=a.n(s);l.a}}]);
//# sourceMappingURL=chunk-e48f924c.82ca8189.js.map